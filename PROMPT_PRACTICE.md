# ğŸ› ï¸ Agent Prompt å®è·µæŒ‡å—

## æ”¹è¿›ä½ çš„ custom_agent_simple.py

ç›®å‰çš„ä»£ç ä¸­ï¼Œprompt è´¨é‡å¯ä»¥å¤§å¹…æ”¹è¿›ã€‚è®©æˆ‘å±•ç¤ºæ€æ ·åšã€‚

---

## ç°çŠ¶åˆ†æ

### ğŸ“ å½“å‰çš„ Promptï¼ˆç¬¬68-93è¡Œï¼‰

```python
prompt = f"""
        ä»»åŠ¡: {task}

        å¯ç”¨å·¥å…·:
        {tools_info}

        è¯·å†³å®šå¦‚ä½•å®Œæˆè¿™ä¸ªä»»åŠ¡ã€‚ä½ å¯ä»¥:
        1. ç›´æ¥å›ç­”
        2. ä½¿ç”¨å·¥å…·(æ ¼å¼: ä½¿ç”¨ å·¥å…·å(å‚æ•°))
        """
```

### âš ï¸ é—®é¢˜åˆ†æ

| é—®é¢˜ | å½±å“ | æ”¹è¿›æ–¹å‘ |
|------|------|---------|
| **è§’è‰²ä¸æ˜ç¡®** | Agentä¸çŸ¥é“è‡ªå·±åº”è¯¥æ€æ ·è¡ŒåŠ¨ | æ·»åŠ è§’è‰²å®šä¹‰ |
| **å·¥å…·æè¿°å¤ªç®€å•** | Agentä¸æ¸…æ¥šå·¥å…·çš„ç”¨é€” | è¯¦ç»†æè¿°æ¯ä¸ªå·¥å…· |
| **æ²¡æœ‰å·¥ä½œæµç¨‹** | Agentå¯èƒ½éšæ„å†³ç­– | æŒ‡å®šæ¸…æ™°çš„æ­¥éª¤ |
| **æ²¡æœ‰çº¦æŸ** | Agentå¯èƒ½åšè¶…å‡ºèŒƒå›´çš„äº‹ | æ·»åŠ çº¦æŸæ¡ä»¶ |
| **è¿”å›æ ¼å¼ä¸æ¸…æ¥š** | éš¾ä»¥è§£æAgentçš„å†³ç­– | æŒ‡å®šæ ‡å‡†è¾“å‡ºæ ¼å¼ |

---

## æ”¹è¿›ç‰ˆæœ¬1ï¸âƒ£: åŸºç¡€æ”¹è¿›

### æ”¹è¿›åçš„ Promptï¼ˆæ¨èç”¨ ReAct èŒƒå¼ï¼‰

```python
def think(self, task: str) -> str:
    """æ€è€ƒé˜¶æ®µ - å†³å®šè¦åšä»€ä¹ˆ"""
    self.state = AgentState.THINKING
    
    # å¯ç”¨å·¥å…·åˆ—è¡¨
    tools_info = "\n".join([
        f"- {name}: {info['description']}"
        for name, info in self.tools.items()
    ])
    
    # âœ¨ æ”¹è¿›çš„ Prompt
    prompt = f"""
ä½ æ˜¯ä¸€ä¸ªæ™ºèƒ½åŠ©æ‰‹ã€‚ä½ éœ€è¦æ ¹æ®ç”¨æˆ·çš„ä»»åŠ¡ï¼Œå†³å®šæ˜¯å¦ä½¿ç”¨å·¥å…·æ¥å®Œæˆå®ƒã€‚

## ä½ çš„è§’è‰²
- ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„ä»»åŠ¡è§£å†³è€…
- ä½ éœ€è¦è°¨æ…ã€æœ‰é€»è¾‘åœ°å®Œæˆä»»åŠ¡
- ä½ åº”è¯¥åœ¨å¿…è¦æ—¶ä½¿ç”¨å·¥å…·

## å¯ç”¨çš„å·¥å…·
{tools_info}

## å·¥ä½œæµç¨‹
æŒ‰ä»¥ä¸‹æ­¥éª¤æ€è€ƒï¼š

Thought: ç”¨æˆ·æƒ³è¦ä»€ä¹ˆï¼Ÿæˆ‘éœ€è¦ä»€ä¹ˆå·¥å…·ï¼Ÿ
Action: æˆ‘åº”è¯¥ä½¿ç”¨å“ªä¸ªå·¥å…·ï¼Ÿ(æˆ–è€…"ç›´æ¥å›ç­”")
Action Input: å·¥å…·éœ€è¦ä»€ä¹ˆå‚æ•°ï¼Ÿ

## çº¦æŸæ¡ä»¶
- ä½ åªèƒ½ä½¿ç”¨ä¸Šé¢åˆ—å‡ºçš„å·¥å…·
- å¦‚æœä¸ç¡®å®šï¼Œå…ˆè§£é‡Šä½ çš„æ€è·¯
- ä¸€æ¬¡åªåšä¸€ä¸ªè¡ŒåŠ¨

## ç”¨æˆ·çš„ä»»åŠ¡
ä»»åŠ¡: {task}

è¯·æŒ‰ä»¥ä¸‹æ ¼å¼å›ç­”ï¼š

Thought: [ä½ çš„åˆ†æ]
Action: [é€‰æ‹©çš„å·¥å…·æˆ–"ç›´æ¥å›ç­”"]
Action Input: [å¦‚æœä½¿ç”¨å·¥å…·ï¼Œè¾“å…¥å‚æ•°]
"""
    
    print(f"\n[æ€è€ƒ] {self.name}æ­£åœ¨æ€è€ƒ...")
    print(f"æç¤º: {prompt}")
    
    return prompt
```

### ğŸ” æ”¹è¿›çš„åœ°æ–¹

âœ… **æ·»åŠ äº†è§’è‰²å®šä¹‰**: è®©Agentæ˜ç™½å®ƒåº”è¯¥æ˜¯ä»€ä¹ˆæ ·çš„
âœ… **è¯¦ç»†çš„å·¥å…·è¯´æ˜**: åŒ…æ‹¬æ¯ä¸ªå·¥å…·çš„åŠŸèƒ½
âœ… **æ˜ç¡®çš„å·¥ä½œæµç¨‹**: Thought â†’ Action â†’ Action Input
âœ… **æ¸…æ™°çš„çº¦æŸ**: æ˜ç¡®è¯´æ˜é™åˆ¶æ¡ä»¶
âœ… **æ ‡å‡†çš„è¾“å‡ºæ ¼å¼**: æ˜“äºè§£æ

---

## æ”¹è¿›ç‰ˆæœ¬2ï¸âƒ£: é«˜çº§æ”¹è¿›ï¼ˆåŒ…å«å®Œæ•´çš„ReActæµç¨‹ï¼‰

```python
def think(self, task: str) -> str:
    """æ€è€ƒé˜¶æ®µ - ä½¿ç”¨ ReAct èŒƒå¼"""
    self.state = AgentState.THINKING
    
    tools_info = "\n".join([
        f"{i+1}. {name}: {info['description']}"
        for i, (name, info) in enumerate(self.tools.items())
    ])
    
    tools_names = ", ".join(self.tools.keys())
    
    prompt = f"""
# æ™ºèƒ½åŠ©æ‰‹ç³»ç»Ÿ

## ç³»ç»Ÿè§’è‰²
ä½ æ˜¯ä¸€ä¸ªå…·æœ‰å·¥å…·ä½¿ç”¨èƒ½åŠ›çš„æ™ºèƒ½åŠ©æ‰‹ã€‚ä½ çš„ç›®æ ‡æ˜¯å‡†ç¡®ã€é«˜æ•ˆåœ°å®Œæˆç”¨æˆ·çš„ä»»åŠ¡ã€‚

## åŸºæœ¬åŸåˆ™
1. ç†è§£ä»»åŠ¡çš„çœŸå®æ„å›¾
2. é€‰æ‹©æœ€åˆé€‚çš„å·¥å…·æˆ–æ–¹æ³•
3. é€æ­¥æ¨è¿›ï¼Œä¸è¦ä¸€æ¬¡åšå¤ªå¤š
4. åœ¨æ¯ä¸€æ­¥éƒ½éªŒè¯ç»“æœ

## å¯ç”¨å·¥å…·åˆ—è¡¨

{tools_info}

## ä½¿ç”¨è§„èŒƒ

### å·¥å…·è°ƒç”¨æ ¼å¼
å¦‚æœéœ€è¦ä½¿ç”¨å·¥å…·ï¼Œè¯·ä½¿ç”¨ä»¥ä¸‹æ ¼å¼ï¼š
```
Action: <å·¥å…·å>
Action Input: <å‚æ•°1=å€¼1, å‚æ•°2=å€¼2, ...>
```

æ”¯æŒçš„å·¥å…·: [{tools_names}]

### ç›´æ¥å›ç­”æ ¼å¼
å¦‚æœä¸éœ€è¦å·¥å…·ï¼Œç›´æ¥ç»™å‡ºç­”æ¡ˆã€‚

## æ¨ç†è¿‡ç¨‹

è¯·ä½¿ç”¨ä»¥ä¸‹æ ¼å¼è¿›è¡Œæ¨ç†ï¼ˆå¯ä»¥æœ‰å¤šä¸ªå¾ªç¯ï¼‰ï¼š

Thought: æˆ‘éœ€è¦åˆ†æä»€ä¹ˆï¼Ÿ
- [åˆ†æç»†èŠ‚]

Action: [é€‰æ‹©å·¥å…·] æˆ– [ç›´æ¥å›ç­”]
Action Input: [å‚æ•°]

Observation: [ä½ å¦‚ä½•åˆ©ç”¨ç»“æœï¼Ÿ]

Thought: [ä¸‹ä¸€æ­¥æ˜¯ä»€ä¹ˆï¼Ÿ]

...ï¼ˆé‡å¤ç›´åˆ°å®Œæˆï¼‰

Final Answer: [æœ€ç»ˆç­”æ¡ˆ]

## é‡è¦çº¦æŸ

âš ï¸ å¿…é¡»éµå®ˆï¼š
1. æœ€å¤šæ‰§è¡Œ 5 ä¸ªæ­¥éª¤
2. æ¯ä¸ªæ­¥éª¤åªåšä¸€ä»¶äº‹
3. ä¸èƒ½ä½¿ç”¨ä¸åœ¨åˆ—è¡¨ä¸­çš„å·¥å…·
4. å¦‚æœä¸ç¡®å®šï¼Œå…ˆæ˜ç¡®è¯´æ˜
5. æ‰€æœ‰è®¡ç®—è¦æ˜¾ç¤ºè¿‡ç¨‹

## ç”¨æˆ·ä»»åŠ¡

**ä»»åŠ¡**: {task}

---

è¯·ç°åœ¨å¼€å§‹åˆ†æå’Œå®Œæˆè¿™ä¸ªä»»åŠ¡ï¼š

Thought:
"""
    
    print(f"\n[æ€è€ƒ] {self.name}æ­£åœ¨æ€è€ƒ...")
    print(f"[Prompté•¿åº¦] {len(prompt)} å­—ç¬¦")
    
    return prompt
```

---

## æ”¹è¿›ç‰ˆæœ¬3ï¸âƒ£: ä»»åŠ¡ç‰¹å®šçš„ Prompt

æ ¹æ®ä¸åŒçš„ä»»åŠ¡ç±»å‹ä½¿ç”¨ä¸åŒçš„Promptï¼š

```python
def create_specialized_prompt(self, task: str, task_type: str) -> str:
    """æ ¹æ®ä»»åŠ¡ç±»å‹åˆ›å»ºç‰¹å®šçš„prompt"""
    
    tools_info = "\n".join([
        f"{name}: {info['description']}"
        for name, info in self.tools.items()
    ])
    
    if task_type == "calculation":
        # ğŸ§® è®¡ç®—ä»»åŠ¡
        return f"""
ä½ æ˜¯ä¸€ä¸ªæ•°å­¦è®¡ç®—åŠ©æ‰‹ã€‚

ä»»åŠ¡: {task}

æ­¥éª¤ï¼š
1. ç†è§£æ•°å­¦é—®é¢˜
2. é€‰æ‹©åˆé€‚çš„è®¡ç®—å·¥å…·
3. æ˜¾ç¤ºè®¡ç®—æ­¥éª¤
4. ç»™å‡ºæœ€ç»ˆç­”æ¡ˆ

å¯ç”¨å·¥å…·ï¼š{tools_info}

æ ¼å¼ï¼š
æ­¥éª¤1: [ç†è§£]
æ­¥éª¤2: [ä½¿ç”¨å·¥å…·]
æ­¥éª¤3: [éªŒè¯]
ç­”æ¡ˆ: [æœ€ç»ˆç­”æ¡ˆ]
"""
    
    elif task_type == "analysis":
        # ğŸ“Š åˆ†æä»»åŠ¡
        return f"""
ä½ æ˜¯ä¸€ä¸ªæ•°æ®åˆ†æå¸ˆã€‚

ä»»åŠ¡: {task}

åˆ†ææ¡†æ¶ï¼š
1. ç†è§£é—®é¢˜èƒŒæ™¯
2. æ”¶é›†å¿…è¦ä¿¡æ¯
3. åˆ†æå’Œè§£è¯»
4. å¾—å‡ºç»“è®º

å¯ç”¨å·¥å…·ï¼š{tools_info}

è¾“å‡ºæ ¼å¼ï¼š
- é—®é¢˜ç†è§£
- ä¿¡æ¯æ”¶é›†
- åˆ†æå‘ç°
- ç»“è®ºå’Œå»ºè®®
"""
    
    elif task_type == "planning":
        # ğŸ“‹ è§„åˆ’ä»»åŠ¡
        return f"""
ä½ æ˜¯ä¸€ä¸ªé¡¹ç›®è§„åˆ’ä¸“å®¶ã€‚

ä»»åŠ¡: {task}

è§„åˆ’æ­¥éª¤ï¼š
1. åˆ†è§£ç›®æ ‡
2. ç¡®å®šæ­¥éª¤
3. ä¼°è®¡èµ„æº
4. åˆ¶å®šæ—¶é—´è¡¨

å¯ç”¨å·¥å…·ï¼š{tools_info}

è¾“å‡ºæ ¼å¼ï¼š
- ç›®æ ‡åˆ†è§£
- æ‰§è¡Œæ­¥éª¤
- æ‰€éœ€èµ„æº
- æ—¶é—´å®‰æ’
"""
    
    else:
        # ğŸ”„ é€šç”¨ä»»åŠ¡
        return self._create_default_prompt(task, tools_info)

# ä½¿ç”¨ç¤ºä¾‹
agent = CustomAgent("æ™ºèƒ½åŠ©æ‰‹")
prompt = agent.create_specialized_prompt(
    task="è®¡ç®—2024 + 1978",
    task_type="calculation"
)
```

---

## ğŸ“ˆ æ•ˆæœå¯¹æ¯”

### ç¤ºä¾‹ä»»åŠ¡ï¼š"è®¡ç®— 10 + 5 çš„ç»“æœ"

#### âŒ æ—§Promptçš„æ•ˆæœ
```
æç¤º: 
    ä»»åŠ¡: è®¡ç®— 10 + 5 çš„ç»“æœ

    å¯ç”¨å·¥å…·:
    - add: æ‰§è¡ŒåŠ æ³•è¿ç®—

    è¯·å†³å®šå¦‚ä½•å®Œæˆè¿™ä¸ªä»»åŠ¡ã€‚ä½ å¯ä»¥:
    1. ç›´æ¥å›ç­”
    2. ä½¿ç”¨å·¥å…·(æ ¼å¼: ä½¿ç”¨ å·¥å…·å(å‚æ•°))

ç»“æœ: å¯èƒ½ä¸æ¸…æ¥šè¯¥ç”¨ä»€ä¹ˆå‚æ•°è°ƒç”¨å·¥å…·
```

#### âœ… æ–°Promptçš„æ•ˆæœ
```
Thought: ç”¨æˆ·è¦æ±‚è®¡ç®—ä¸¤ä¸ªæ•°çš„å’Œï¼Œæˆ‘åº”è¯¥ä½¿ç”¨addå·¥å…·
Action: add
Action Input: a=10, b=5

Observation: ç»“æœæ˜¯15

Final Answer: 10 + 5 = 15

ç»“æœ: æ¸…æ™°ã€å¯è§£æã€èƒ½éªŒè¯
```

---

## ğŸ¯ Prompt ä¼˜åŒ–æ£€æŸ¥æ¸…å•

åœ¨ä¼˜åŒ–Promptæ—¶ï¼Œæ£€æŸ¥è¿™äº›é¡¹ç›®ï¼š

- [ ] **è§’è‰²æ¸…æ™°** - AgentçŸ¥é“è‡ªå·±çš„èº«ä»½å—ï¼Ÿ
- [ ] **ä»»åŠ¡æ˜ç¡®** - ç›®æ ‡æ˜¯å¦æ¸…æ¥šï¼Ÿ
- [ ] **å·¥å…·å®Œæ•´** - æ‰€æœ‰å¯ç”¨å·¥å…·éƒ½æœ‰æè¿°å—ï¼Ÿ
- [ ] **æµç¨‹æ¸…æ™°** - å·¥ä½œæ­¥éª¤æ˜¯å¦æ˜ç¡®ï¼Ÿ
- [ ] **æ ¼å¼æ ‡å‡†** - è¾“å‡ºæ ¼å¼æ˜¯å¦å…·ä½“ï¼Ÿ
- [ ] **çº¦æŸæ˜ç¡®** - é™åˆ¶æ¡ä»¶æ˜¯å¦æ¸…æ¥šï¼Ÿ
- [ ] **ç¤ºä¾‹å……åˆ†** - æœ‰è¶³å¤Ÿçš„ä¾‹å­å—ï¼Ÿ
- [ ] **å¯æµ‹è¯•** - èƒ½å¦éªŒè¯æ•ˆæœï¼Ÿ

---

## ğŸš€ å®è·µä»»åŠ¡

### Task 1: æ”¹è¿›ä½ çš„ Agent Prompt

æ‰“å¼€ `custom_agent_simple.py`ï¼Œæ›´æ–° `think` æ–¹æ³•ï¼š

```python
# æ‰¾åˆ° think æ–¹æ³•ï¼ˆç¬¬68è¡Œï¼‰
# å°† prompt æ”¹ä¸ºæ”¹è¿›ç‰ˆæœ¬1æˆ–2
# è¿è¡Œä»£ç çœ‹çœ‹æ•ˆæœ
```

### Task 2: æ·»åŠ  task_type å‚æ•°

æ‰©å±•Agentæ”¯æŒä¸åŒä»»åŠ¡ç±»å‹ï¼š

```python
class CustomAgent:
    def __init__(self, name: str):
        self.name = name
        self.task_type = "general"  # â† æ·»åŠ è¿™è¡Œ
    
    def run(self, task: str, task_type: str = "general") -> str:
        """è¿è¡ŒAgentï¼Œæ”¯æŒæŒ‡å®šä»»åŠ¡ç±»å‹"""
        self.task_type = task_type  # â† è®¾ç½®ä»»åŠ¡ç±»å‹
        # ... å…¶ä½™ä»£ç 
```

### Task 3: æµ‹è¯•å¯¹æ¯”

```python
# åˆ›å»ºæµ‹è¯•
agent = CustomAgent("æµ‹è¯•Agent")
agent.register_tool("add", add_numbers, "æ‰§è¡ŒåŠ æ³•è¿ç®—")

# æµ‹è¯•ç›¸åŒçš„ä»»åŠ¡
task = "è®¡ç®— 100 + 50"
result1 = agent.run(task)  # ä½¿ç”¨æ—§Prompt
result2 = agent.run(task, task_type="calculation")  # ä½¿ç”¨æ–°Prompt

# æ¯”è¾ƒç»“æœçš„æ¸…æ™°åº¦å’Œå¯è§£ææ€§
```

---

## ğŸ’¡ å…³é”®æ´å¯Ÿ

**æœ€é‡è¦çš„3ç‚¹**ï¼š

1. **æ¸…æ™°æ€§æœ€é‡è¦**
   - æ¨¡å‹èƒ½æœ‰å¤šå¥½å®Œå…¨å–å†³äºä½ çš„æŒ‡ä»¤æœ‰å¤šæ¸…æ¥š
   - æŠ•å…¥æ—¶é—´æ”¹è¿›Promptæ¯”æ”¹ä»£ç æ›´æœ‰æ•ˆ

2. **å…·ä½“ä¾‹å­å¾ˆå…³é”®**
   - ä¸€ä¸ªå¥½ä¾‹å­èƒœè¿‡åƒè¨€ä¸‡è¯­
   - ç”¨ä½ çš„Agentä¼šé‡åˆ°çš„çœŸå®ä¾‹å­

3. **çº¦æŸå¾ˆå¿…è¦**
   - æ˜ç¡®è¯´æ˜ä»€ä¹ˆèƒ½åšï¼Œä»€ä¹ˆä¸èƒ½åš
   - é˜²æ­¢Agentåšæ„å¤–çš„äº‹

---

**ç°åœ¨å°±è¯•è¯•æ”¹è¿›ä½ çš„Promptå§ï¼** ğŸš€
